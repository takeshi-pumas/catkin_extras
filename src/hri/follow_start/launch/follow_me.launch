<?xml version="1.0" encoding="utf-8"?>
<launch>

  <arg name="cmd_vel_name" default="/hsrb/command_velocity"/>
  <arg name="laser_scan_topic" default="/hsrb/base_scan"/>
  <arg name="point_cloud_topic" default="/hsrb/head_rgbd_sensor/depth_registered/rectified_points"/>
  <arg name="point_cloud_topic2" default="/hsrb/head_rgbd_sensor/depth_registered/rectified_points"/>
  <arg name="bumper_f_topic" default="hsrb/base_f_bumper_sensor"/>
  
  <arg name="use_lidar" default="True"/>
  <arg name="use_sonars" default="False"/>
  <arg name="use_point_cloud" default="False"/>
  <arg name="use_point_cloud2" value="True"/>
  <arg name="use_bumper" default="False"/>
  <arg name="use_pot_fields" default="True"/>
  <arg name="cloud_downsampling" default="5"/>
  <arg name="lidar_downsampling" default="1"/>
  <arg name="cloud_points_threshold" default="100"/>
  <arg name="lidar_points_threshold" default="20"/>
  
  <arg name="min_x" default="0.17"/>
  <arg name="max_x" default="0.50"/>
  <arg name="min_y" default="-0.25"/>
  <arg name="max_y" default="0.25"/>
  <arg name="min_z" default="0.025"/>
  <arg name="max_z" default="1.00"/>


  <group ns="hri">
      <node name="leg_finder" pkg="leg_finder" type="leg_finder_node" output="screen">
        <param name="scan_downsampling" value="1"/>
        <param name="laser_scan_frame" value="base_range_sensor_link"/>
        <param name="laser_scan_topic" value="/hsrb/base_scan"/>
        <param name="show_hypothesis" value="False"/>
      </node>
      
      <node name="potential_fields"  pkg="potential_fields"  type="pot_fields_node"  output="screen">

	<param name="laser_scan_topic" value="$(arg laser_scan_topic)"/>
	    <param name="point_cloud_topic" value="$(arg point_cloud_topic)"/>
	    <param name="point_cloud_topic2" value="$(arg point_cloud_topic2)"/>
	    <param name="bumper_f_topic" value="$(arg bumper_f_topic)"/>
	    
	    <param name="use_lidar" value="$(arg use_lidar)"/>
	    <param name="use_sonars" value="$(arg use_sonars)"/>
	    <param name="use_point_cloud" value="$(arg use_point_cloud)"/>
	    <param name="use_point_cloud2" value="$(arg point_cloud_topic2)"/>
	    <param name="use_bumper" value="$(arg use_bumper)"/>
	    <param name="use_pot_fields" value="$(arg use_pot_fields)"/>
	    
	    <param name="cloud_downsampling" value="$(arg cloud_downsampling)"/>
	    <param name="cloud_points_threshold" value="$(arg cloud_points_threshold)"/>
	    <param name="lidar_points_threshold" value="$(arg lidar_points_threshold)"/>
	    
	    <param name="debug" value="False"/>
	    
	    <param name="pot_fields_d0" value="0.40"/>
	    <param name="pot_fields_k_rej" value="1.0"/>
	    
	    <param name="max_x" value="$(arg max_x)"/>
	    <param name="min_x" value="$(arg min_x)"/>
	    <param name="max_y" value="$(arg max_y)"/>
	    <param name="min_y" value="$(arg min_y)"/>
	    <param name="max_z" value="$(arg max_z)"/>
	    <param name="min_z" value="$(arg min_z)"/>
  </node>

      <node name="human_follower" pkg="human_follower" type="human_follower_node" output="screen" args="--move_head">
        <param name="control_alpha" value="0.8"/>
        <param name="control_beta" value="0.3"/>
        <param name="max_linear" value="0.7"/>
        <param name="max_angular" value="0.7"/>
        <param name="dist_to_human" value="0.9"/>
        <param name="move_backwards" value="False"/>
        <param name="move_head" value="True"/>
        <param name="pot_fields" value="True"/>
        <param name="legs_pose_topic" value="/hri/leg_finder/leg_pose"/>
        <param name="cmd_vel_topic" value="/hsrb/command_velocity"/>
        <param name="head_topic" value="/hardware/head/goal_pose"/>
      </node>
  </group>

</launch>
